<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Reaction Timer</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0F172A;
            color: #F1F5F9;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .container {
            max-width: 1000px;
            width: 100%;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            text-align: center;
        }

        #instructions {
            color: #64748B;
            margin-bottom: 2rem;
            line-height: 1.6;
            text-align: center;
            font-size: 1.1rem;
        }

        #game-container {
            background: #1E293B;
            border-radius: 1.5rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        #reaction-display {
            position: absolute;
            top: 2rem;
            right: 2rem;
            text-align: right;
            z-index: 10;
        }

        #reaction-label {
            color: #64748B;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        #reaction-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            color: #10B981;
            line-height: 1;
        }

        #canvas-box {
            background: #0F172A;
            border-radius: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: box-shadow 0.3s ease;
            position: relative;
        }

        #canvas-box:hover {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        #canvas-box.waiting {
            cursor: wait;
        }

        #canvas-box.ready {
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
        }

        #message-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            pointer-events: none;
            z-index: 5;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        #controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        #start-btn, #reset-stats-btn {
            background: #3B82F6;
            color: #F1F5F9;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        #reset-stats-btn {
            background: #64748B;
        }

        #start-btn:hover {
            background: #2563EB;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        #reset-stats-btn:hover {
            background: #475569;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4);
        }

        #start-btn:active, #reset-stats-btn:active {
            transform: translateY(0);
        }

        #start-btn:disabled {
            background: #64748B;
            cursor: not-allowed;
            transform: none;
        }

        #stats {
            background: #1E293B;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        #stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        #stats-header h2 {
            font-size: 1.2rem;
            color: #F1F5F9;
            margin: 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: #64748B;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: #3B82F6;
        }

        .hidden {
            opacity: 0;
        }

        #instructions-modal {
            background: #1E293B;
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 1px solid #334155;
        }

        #instructions-modal.hidden {
            display: none;
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .modal-content h2 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: #F1F5F9;
        }

        .instructions-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .modal-content h3 {
            font-size: 0.8rem;
            margin-bottom: 0.6rem;
            color: #3B82F6;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .instructions-section {
            margin-bottom: 0;
        }

        .modal-content p {
            color: #94A3B8;
            font-size: 0.8rem;
            margin-top: 0.8rem;
        }

        .instructions-step {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.6rem;
        }

        .step-number {
            background: #3B82F6;
            color: white;
            width: 1.3rem;
            height: 1.3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
            font-size: 0.75rem;
        }

        .step-text {
            color: #CBD5E1;
            line-height: 1.4;
            font-size: 0.85rem;
        }

        .score-categories {
            display: grid;
            gap: 0.5rem;
        }

        .score-category {
            padding: 0.6rem;
            border-radius: 0.5rem;
            border-left: 2px solid;
            background: rgba(59, 130, 246, 0.05);
        }

        .score-category.amazing {
            border-left-color: #10B981;
        }

        .score-category.very-good {
            border-left-color: #3B82F6;
        }

        .score-category.good {
            border-left-color: #8B5CF6;
        }

        .score-category.average {
            border-left-color: #F59E0B;
        }

        .score-category.below {
            border-left-color: #EF4444;
        }

        .score-category strong {
            display: block;
            color: #F1F5F9;
            margin-bottom: 0.1rem;
            font-size: 0.8rem;
        }

        .score-category span {
            color: #94A3B8;
            font-size: 0.75rem;
            font-family: 'JetBrains Mono', monospace;
        }

        #start-from-modal {
            background: #3B82F6;
            color: #F1F5F9;
            border: none;
            padding: 0.75rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1.2rem;
        }

        #start-from-modal:hover {
            background: #2563EB;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        #start-from-modal:active {
            transform: translateY(0);
        }

        @media (max-width: 640px) {
            body {
                padding: 1rem;
            }

            h1 {
                font-size: 1.8rem;
            }

            #instructions {
                font-size: 1rem;
            }

            #game-container {
                padding: 1rem;
            }

            #reaction-display {
                top: 1rem;
                right: 1rem;
            }

            #reaction-time {
                font-size: 1.8rem;
            }

            #message-overlay {
                font-size: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>3D Reaction Timer</h1>
        <p id="instructions">Click Start, then click the shape as fast as you can when it turns blue!</p>
        
        <!-- Instructions Section -->
        <div id="instructions-modal">
            <div class="modal-content">
                <h2>üéÆ How to Play</h2>
                
                <div class="instructions-wrapper">
                    <div class="instructions-section">
                        <h3>Steps</h3>
                        <div class="instructions-step">
                            <div class="step-number">1</div>
                            <div class="step-text">Click <strong>Start Game</strong> to begin</div>
                        </div>
                        <div class="instructions-step">
                            <div class="step-number">2</div>
                            <div class="step-text">Wait for the shape to turn <strong>blue</strong> (2-5 seconds)</div>
                        </div>
                        <div class="instructions-step">
                            <div class="step-number">3</div>
                            <div class="step-text">Click the shape <strong>as fast as you can</strong> when you see "CLICK NOW!"</div>
                        </div>
                        <div class="instructions-step">
                            <div class="step-number">4</div>
                            <div class="step-text">Your reaction time is shown at the top right</div>
                        </div>
                    </div>

                    <div class="instructions-section">
                        <h3>‚ö° Score Ratings</h3>
                        <div class="score-categories">
                            <div class="score-category amazing">
                                <strong>ü§Ø Amazing</strong>
                                <span>&lt; 200ms</span>
                            </div>
                            <div class="score-category very-good">
                                <strong>‚ú® Very Good</strong>
                                <span>200-250ms</span>
                            </div>
                            <div class="score-category good">
                                <strong>üëç Good</strong>
                                <span>250-300ms</span>
                            </div>
                            <div class="score-category average">
                                <strong>üìä Average</strong>
                                <span>300-350ms</span>
                            </div>
                            <div class="score-category below">
                                <strong>üê¢ Below Avg</strong>
                                <span>&gt; 350ms</span>
                            </div>
                        </div>
                    </div>
                </div>

                <p>‚ö†Ô∏è <strong>Tip:</strong> Clicking before the shape turns blue counts as too early and won't register.</p>
            </div>
        </div>
        
        <div id="game-container">
            <div id="reaction-display">
                <div id="reaction-label">Reaction Time</div>
                <div id="reaction-time" class="hidden">--</div>
            </div>
            
            <div id="canvas-box">
                <div id="message-overlay"></div>
            </div>
            
            <div id="controls">
                <button id="start-btn">Start Game</button>
            </div>
        </div>

        <div id="reaction-display">
            <div id="reaction-label">Reaction Time</div>
            <div id="reaction-time" class="hidden">--</div>
        </div>
        
        <div id="stats">
            <div id="stats-header">
                <h2>Session Statistics</h2>
                <button id="reset-stats-btn">Reset Stats</button>
            </div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">Attempts</div>
                    <div class="stat-value" id="attempts">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Best Time</div>
                    <div class="stat-value" id="best-time">--</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Average</div>
                    <div class="stat-value" id="avg-time">--</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // ============================================
        // THREE.JS SCENE SETUP
        // ============================================
        
        let scene, camera, renderer, shape;
        const canvasBox = document.getElementById('canvas-box');
        
        function initThreeJS() {
            // Scene setup
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0F172A);
            
            // Camera setup
            const aspect = 16 / 9;
            const height = Math.min(500, window.innerWidth * 0.5);
            const width = height * aspect;
            
            camera = new THREE.PerspectiveCamera(75, aspect, 0.1, 1000);
            camera.position.z = 4;
            
            // Renderer setup
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(window.devicePixelRatio);
            canvasBox.appendChild(renderer.domElement);
            
            // Create interesting shape - dodecahedron with wireframe overlay
            const geometry = new THREE.DodecahedronGeometry(1.5, 0);
            const material = new THREE.MeshPhongMaterial({ 
                color: 0x64748B,
                shininess: 100,
                specular: 0x555555,
                flatShading: true
            });
            shape = new THREE.Mesh(geometry, material);
            
            // Add wireframe for extra detail
            const wireframeGeo = new THREE.EdgesGeometry(geometry);
            const wireframeMat = new THREE.LineBasicMaterial({ 
                color: 0x1E293B, 
                linewidth: 2 
            });
            const wireframe = new THREE.LineSegments(wireframeGeo, wireframeMat);
            shape.add(wireframe);
            
            scene.add(shape);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const light1 = new THREE.DirectionalLight(0xffffff, 0.8);
            light1.position.set(5, 5, 5);
            scene.add(light1);
            
            const light2 = new THREE.DirectionalLight(0x3B82F6, 0.4);
            light2.position.set(-5, -3, 2);
            scene.add(light2);
            
            const light3 = new THREE.DirectionalLight(0x10B981, 0.3);
            light3.position.set(0, -5, -3);
            scene.add(light3);
            
            // Handle window resize
            window.addEventListener('resize', onWindowResize);
            
            // Start animation loop
            animate();
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Smooth continuous rotation
            shape.rotation.x += 0.005;
            shape.rotation.y += 0.008;
            
            renderer.render(scene, camera);
        }
        
        function onWindowResize() {
            const aspect = 16 / 9;
            const height = Math.min(500, window.innerWidth * 0.5);
            const width = height * aspect;
            
            camera.aspect = aspect;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }
        
        // Shape animation functions
        function setShapeState(state) {
            const colors = {
                waiting: 0x64748B,
                ready: 0x3B82F6,
                success: 0x10B981,
                error: 0xEF4444
            };
            
            const targetColor = new THREE.Color(colors[state]);
            
            // Animate color change
            animateColor(targetColor, 400);
            
            // Different rotation speeds for different states
            if (state === 'ready') {
                animateRotationSpeed(0.03);
            } else if (state === 'success') {
                animateRotationSpeed(0.02);
                doPulse();
            } else if (state === 'error') {
                animateRotationSpeed(0.001);
                doShake();
            } else {
                animateRotationSpeed(0.008);
            }
        }
        
        function animateColor(targetColor, duration) {
            const startColor = shape.material.color.clone();
            const start = Date.now();
            
            function update() {
                const elapsed = Date.now() - start;
                const progress = Math.min(elapsed / duration, 1);
                
                shape.material.color.lerpColors(startColor, targetColor, easeOutCubic(progress));
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            update();
        }
        
        let currentRotationSpeed = 0.008;
        let targetRotationSpeed = 0.008;
        
        function animateRotationSpeed(target) {
            targetRotationSpeed = target;
        }
        
        // Update rotation in animate loop
        function updateRotation() {
            currentRotationSpeed += (targetRotationSpeed - currentRotationSpeed) * 0.1;
            shape.rotation.y += currentRotationSpeed;
        }
        
        // Modify animate function
        const originalAnimate = animate;
        animate = function() {
            requestAnimationFrame(animate);
            updateRotation();
            renderer.render(scene, camera);
        };
        
        function doPulse() {
            const originalScale = shape.scale.x;
            const start = Date.now();
            const duration = 600;
            
            function update() {
                const elapsed = Date.now() - start;
                const progress = Math.min(elapsed / duration, 1);
                
                const scale = originalScale + Math.sin(progress * Math.PI) * 0.3;
                shape.scale.set(scale, scale, scale);
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    shape.scale.set(1, 1, 1);
                }
            }
            
            update();
        }
        
        function doShake() {
            const duration = 400;
            const start = Date.now();
            const originalRotation = { x: shape.rotation.x, y: shape.rotation.y };
            
            function update() {
                const elapsed = Date.now() - start;
                const progress = Math.min(elapsed / duration, 1);
                
                if (progress < 1) {
                    const intensity = (1 - progress) * 0.2;
                    shape.rotation.x = originalRotation.x + (Math.random() - 0.5) * intensity;
                    shape.rotation.z = (Math.random() - 0.5) * intensity;
                    requestAnimationFrame(update);
                } else {
                    shape.rotation.z = 0;
                }
            }
            
            update();
        }
        
        function easeOutCubic(x) {
            return 1 - Math.pow(1 - x, 3);
        }
        
        // ============================================
        // GAME STATE MANAGEMENT
        // ============================================
        
        const gameState = {
            phase: 'idle', // idle, waiting, ready, result
            startTime: null,
            reactionTime: null,
            attempts: 0,
            times: [],
            timeoutId: null
        };
        
        // ============================================
        // UI ELEMENTS
        // ============================================
        
        const elements = {
            startBtn: document.getElementById('start-btn'),
            instructionsModal: document.getElementById('instructions-modal'),
            resetStatsBtn: document.getElementById('reset-stats-btn'),
            message: document.getElementById('message-overlay'),
            reactionTime: document.getElementById('reaction-time'),
            instructions: document.getElementById('instructions'),
            attempts: document.getElementById('attempts'),
            bestTime: document.getElementById('best-time'),
            avgTime: document.getElementById('avg-time'),
            canvasBox: canvasBox
        };
        
        // ============================================
        // GAME LOGIC
        // ============================================
        
        function startGame() {
            gameState.phase = 'waiting';
            updateUI();
            setShapeState('waiting');
            
            // Random delay between 2-5 seconds
            const delay = 2000 + Math.random() * 3000;
            
            gameState.timeoutId = setTimeout(() => {
                if (gameState.phase === 'waiting') {
                    showStimulus();
                }
            }, delay);
        }
        
        function showStimulus() {
            gameState.phase = 'ready';
            gameState.startTime = Date.now();
            setShapeState('ready');
            updateUI();
        }
        
        function handleCanvasClick() {
            if (gameState.phase === 'waiting') {
                // Clicked too early
                clearTimeout(gameState.timeoutId);
                gameState.phase = 'error';
                setShapeState('error');
                updateUI();
            } else if (gameState.phase === 'ready') {
                // Valid click - calculate reaction time
                gameState.reactionTime = Date.now() - gameState.startTime;
                gameState.phase = 'result';
                gameState.attempts++;
                gameState.times.push(gameState.reactionTime);
                setShapeState('success');
                updateUI();
                updateStats();
            }
        }
        
        function resetGame() {
            gameState.phase = 'idle';
            gameState.startTime = null;
            gameState.reactionTime = null;
            if (gameState.timeoutId) {
                clearTimeout(gameState.timeoutId);
            }
            setShapeState('waiting');
            updateUI();
        }
        
        // ============================================
        // UI UPDATE FUNCTIONS
        // ============================================
        
        function updateUI() {
            // Remove all canvas box classes
            elements.canvasBox.classList.remove('waiting', 'ready');
            
            switch(gameState.phase) {
                case 'idle':
                    elements.startBtn.textContent = 'Start Game';
                    elements.startBtn.disabled = false;
                    elements.message.textContent = '';
                    elements.reactionTime.classList.add('hidden');
                    break;
                    
                case 'waiting':
                    elements.canvasBox.classList.add('waiting');
                    elements.startBtn.disabled = true;
                    elements.message.textContent = 'Wait for it...';
                    elements.message.style.color = '#64748B';
                    elements.reactionTime.classList.add('hidden');
                    break;
                    
                case 'ready':
                    elements.canvasBox.classList.add('ready');
                    elements.message.textContent = 'CLICK NOW!';
                    elements.message.style.color = '#3B82F6';
                    break;
                    
                case 'result':
                    elements.startBtn.textContent = 'Play Again';
                    elements.startBtn.disabled = false;
                    elements.message.textContent = '';
                    elements.reactionTime.textContent = `${gameState.reactionTime}ms`;
                    elements.reactionTime.classList.remove('hidden');
                    break;
                    
                case 'error':
                    elements.startBtn.textContent = 'Try Again';
                    elements.startBtn.disabled = false;
                    elements.message.textContent = 'Too early!';
                    elements.message.style.color = '#EF4444';
                    elements.reactionTime.classList.add('hidden');
                    break;
            }
        }
        
        function updateStats() {
            elements.attempts.textContent = gameState.attempts;
            
            if (gameState.times.length > 0) {
                const best = Math.min(...gameState.times);
                elements.bestTime.textContent = `${best}ms`;
                
                const avg = Math.round(gameState.times.reduce((a, b) => a + b, 0) / gameState.times.length);
                elements.avgTime.textContent = `${avg}ms`;
            }
        }
        
        function resetStats() {
            gameState.attempts = 0;
            gameState.times = [];
            elements.attempts.textContent = '0';
            elements.bestTime.textContent = '--';
            elements.avgTime.textContent = '--';
            resetGame();
        }
        
        // ============================================
        // EVENT LISTENERS
        // ============================================
        
        elements.startBtn.addEventListener('click', () => {
            resetGame();
            startGame();
        });
        
        elements.resetStatsBtn.addEventListener('click', resetStats);
        
        elements.canvasBox.addEventListener('click', handleCanvasClick);
        
        // ============================================
        // INITIALIZATION
        // ============================================
        
        initThreeJS();
    </script>
</body>
</html>
